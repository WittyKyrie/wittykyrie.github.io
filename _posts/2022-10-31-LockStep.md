---
title: 帧同步和状态同步
author: wittykyrie
date: 2022-10-25 09:00:00 +0800
categories: ['帧同步','状态同步']
tags: ['帧同步','状态同步']
render_with_liquid: false
---

在多人联机得网络游戏当中，我们需要使用网络同步来保证每一台机器的游戏表现完全一致。例如在英雄联盟当中，我们需要在十位玩家的显示屏上显示相同的英雄位置，技能释放角度，和技能特效。同时对于大部分游戏来说，我们也需要客户端和服务端的游戏逻辑数据也要保持一致。

同步游戏数据包括但不限于：技能逻辑、普攻、属性、伤害、移动、AI、检测、碰撞等等。

现在网络同步按照大类分有两种做法，帧同步和状态同步。

## 帧同步 Lockstep

帧同步的运作模式是，游戏的所有逻辑在客户端，客户端按照一定的逻辑帧向服务器上传操作指令，服务器收到操作指令后将其传递给其余的客户端。

其余的客户端收到指令之后，如果计算的过程一致，接收到的指令一致，那么计算结果肯定是一致的，这样就能保证所有的客户端同步，这就是帧同步的基本运行方式。

像这样：


但是同样也存在着一些弊端，因为帧同步的战斗逻辑都写在客户端，所以如果修改了客户端的战斗逻辑，就能很轻易的产生加速，透视，自动瞄准等外挂。

同时，由于不同机器的浮点数精度存在着不同，对于某些需要大量计算数据的游戏而言，微小的浮点数差距也会带来截然不同的结果，但我们通常会使用定点数来解决。

还有由于部分客户端网速较差的影响其他客户端游戏体验的问题，但是也有着很多的优化方案，类似于客户端预执行，渲染逻辑分离等



